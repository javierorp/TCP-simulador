<span *ngIf="mostrar | async; else loading">
    <a class="cont-bug" style="color: black" href="mailto:{{ pck.email }}?subject={{ 'simulacion.reportar' | translate }}
    &body={{ 'error.parametros' | translate }}%20{{ parametros }}%0A-----{{ 'error.tutexto' | translate }}-----%0A%0A">
        <button class="btn bug" title="{{ 'simulacion.reportar' | translate }}"
            ngbPopover="{{ 'simulacion.reportar-texto' | translate }}" triggers="mouseenter:mouseleave"
            popoverTitle="{{ 'simulacion.reportar-titulo' | translate }}">
            <fa-icon [icon]="faBug"></fa-icon>
        </button>
    </a>
    <table>
        <tr>
            <th class="clien">
                <fa-icon class="fas fa-laptop fa-2x-laptop" [icon]="faLaptop"
                    title="{{ 'simulacion.clien' | translate }}"></fa-icon>
                <br><span class="ipcli" title="{{ 'simulacion.ipclien' | translate }}">{{ ipclien }}</span>
            </th>
            <th></th>
            <th class="serv">
                <fa-icon class="fas fa-server fa-2x-server" [icon]="faServer"
                    title="{{ 'simulacion.serv' | translate }}"></fa-icon>
                <br><span class="ipserv" title="{{ 'simulacion.ipserv' | translate }}">{{ ipserv }}</span>
            </th>
        </tr>
    </table>

    <table class="flujo">
        <tr *ngFor="let conversacion of comunicacion">
            <!-- Espacio en blanco en la tabla -->
            <span *ngIf="conversacion.dir == null">
                <td class="info-izq">
                </td>
                <td>
                    <span title="">
                        <img src="assets\img\vacio.svg" alt="null" class="flecha" draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                </td>
            </span>


            <!-- Direccion bidireccional cliente<->servidor con VC en cliente-->
            <span *ngIf="conversacion.dir == 0">
                <td class="info-izq">
                    <span *ngIf="conversacion.flagcli[3] != ''" title="{{ 'simulacion.al' | translate }}" class="modo">&nbsp;{{ 'simulacion.al_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagcli[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagcli[5] != ''" title="{{ 'simulacion.rr' | translate }}" class="modo">&nbsp;{{ 'simulacion.rr_letra' | translate }}&nbsp;</span>&nbsp;
                    <span *ngIf="conversacion.vc != 0" title="{{ 'simulacion.vc' | translate }}" class="vccli">&nbsp;{{ 'simulacion.vc_letra' | translate }}={{ conversacion.vc }}&nbsp;</span>
                    <span title="{{ 'simulacion.sn' | translate }}">&nbsp;SN={{ conversacion.sncli }}, </span>
                    <span *ngIf="conversacion.ancli != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.ancli }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dcli }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wcli }}</span>
                </td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flechaDoble.svg" alt="cliente<---->servidor" class="flecha"
                            draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                    <span title="{{ 'simulacion.sn' | translate }}">SN={{ conversacion.snserv }}, </span>
                    <span *ngIf="conversacion.anserv != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.anserv }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dserv }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wserv }}</span>
                </td>
            </span>

            <!-- Direccion bidireccional cliente<->servidor con VC en servidor-->
            <span *ngIf="conversacion.dir == 10">
                <td class="info-izq">
                    <span title="{{ 'simulacion.sn' | translate }}">&nbsp;SN={{ conversacion.sncli }}, </span>
                    <span *ngIf="conversacion.ancli != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.ancli }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dcli }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wcli }}</span>
                </td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flechaDoble.svg" alt="cliente<---->servidor" class="flecha"
                            draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                    <span title="{{ 'simulacion.sn' | translate }}">SN={{ conversacion.snserv }}, </span>
                    <span *ngIf="conversacion.anserv != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.anserv }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dserv }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wserv }}</span>&nbsp;
                    <span *ngIf="conversacion.vc != 0" title="{{ 'simulacion.vc' | translate }}" class="vcserv">&nbsp;{{ 'simulacion.vc_letra' | translate }}={{ conversacion.vc }}&nbsp;</span>&nbsp;
                    <span *ngIf="conversacion.flagserv[3] != ''" title="{{ 'simulacion.al' | translate }}" class="modo">&nbsp;{{ 'simulacion.al_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagserv[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagserv[5] != ''" title="{{ 'simulacion.rr' | translate }}" class="modo">&nbsp;{{ 'simulacion.rr_letra' | translate }}&nbsp;</span>
                </td>
            </span>

            <!-- Direccion cliente->servidor -->
            <span *ngIf="conversacion.dir == 1">
                <td class="info-izq">
                    <span *ngIf="conversacion.flagcli[3] != ''" title="{{ 'simulacion.al' | translate }}" class="modo">&nbsp;{{ 'simulacion.al_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagcli[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagcli[5] != ''" title="{{ 'simulacion.rr' | translate }}" class="modo">&nbsp;{{ 'simulacion.rr_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagcli[0] != ''" title="{{ 'simulacion.syn' | translate }}" class="flagcli">&nbsp;{{ 'simulacion.syn_letra' | translate }},</span>
                    <span *ngIf="conversacion.flagcli[1] != ''" title="{{ 'simulacion.fin' | translate }}" class="flagcli">&nbsp;{{ 'simulacion.fin_letra' | translate }},</span>
                    <span *ngIf="conversacion.flagcli[2] != ''" title="{{ 'simulacion.ack' | translate }}" class="flagcli">&nbsp;{{ 'simulacion.ack_letra' | translate }},</span>
                    <span title="{{ 'simulacion.sn' | translate }}">&nbsp;SN={{ conversacion.sncli }}, </span>
                    <span *ngIf="conversacion.msscli != 0" title="{{ 'simulacion.mss' | translate }}">
                        MSS={{ conversacion.msscli }},
                    </span>
                    <span *ngIf="conversacion.ancli != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.ancli }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dcli }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wcli }}</span>
                </td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flecha.svg" alt="cliente----><!--servidor" class="flechacli"
                            draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                    <span *ngIf="conversacion.vc != 0" title="{{ 'simulacion.vc' | translate }}" class="vcserv">&nbsp;{{ 'simulacion.vc_letra' | translate }}={{ conversacion.vc }}&nbsp;</span>&nbsp;
                    <span *ngIf="conversacion.flagserv[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>

                </td>
            </span>

            <!-- Direccion servidor->cliente -->
            <span *ngIf="conversacion.dir == 2">
                <td class="info-izq">
                    <span *ngIf="conversacion.flagcli[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>&nbsp;
                    <span *ngIf="conversacion.vc != 0" title="{{ 'simulacion.vc' | translate }}" class="vccli">&nbsp;{{ 'simulacion.vc_letra' | translate }}={{ conversacion.vc }}&nbsp;</span>
                </td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flecha.svg" alt="cliente<----servidor" class="flechaserv"
                            style="transform: scaleX(-1);" draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                    <span title="{{ 'simulacion.sn' | translate }}">SN={{ conversacion.snserv }}, </span>
                    <span *ngIf="conversacion.mssserv != 0" title="{{ 'simulacion.mss' | translate }}">
                        MSS={{ conversacion.mssserv }}, </span>
                    <span *ngIf="conversacion.anserv != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.anserv }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dserv }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wserv }}</span>
                    <span *ngIf="conversacion.flagserv[0] != ''" title="{{ 'simulacion.syn' | translate }}" class="flagserv">,&nbsp;{{ 'simulacion.syn_letra' | translate }}</span>
                    <span *ngIf="conversacion.flagserv[1] != ''" title="{{ 'simulacion.fin' | translate }}" class="flagserv">,&nbsp;{{ 'simulacion.fin_letra' | translate }}</span>
                    <span *ngIf="conversacion.flagserv[2] != ''" title="{{ 'simulacion.ack' | translate }}" class="flagserv">,&nbsp;{{ 'simulacion.ack_letra' | translate }}</span>&nbsp;
                    <span *ngIf="conversacion.flagserv[3] != ''" title="{{ 'simulacion.al' | translate }}" class="modo">&nbsp;{{ 'simulacion.al_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagserv[4] != ''" title="{{ 'simulacion.ec' | translate }}" class="modo">&nbsp;{{ 'simulacion.ec_letra' | translate }}&nbsp;</span>
                    <span *ngIf="conversacion.flagserv[5] != ''" title="{{ 'simulacion.rr' | translate }}" class="modo">&nbsp;{{ 'simulacion.rr_letra' | translate }}&nbsp;</span>
                </td>
            </span>

            <!-- {{ 'simulacion.seg' | translate }} perdido en direccion cliente->servidor -->
            <span *ngIf="conversacion.dir == -1">
                <td class="info-izq">
                    <span *ngIf="conversacion.flagcli != null"
                        title="Flags"><strong>{{ conversacion.flagcli }}</strong>,
                    </span>
                    <span title="{{ 'simulacion.sn' | translate }}">SN={{ conversacion.sncli }}, </span>
                    <span *ngIf="conversacion.msscli != 0" title="{{ 'simulacion.mss' | translate }}">
                        MSS={{ conversacion.msscli }},
                    </span>
                    <span *ngIf="conversacion.ancli != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.ancli }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dcli }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wcli }}</span>
                </td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flechaX.svg" alt="clientes--X  servidor" class="flechaperd"
                            draggable="false" />
                    </span>
                </td>
                <td class="info-dcha"></td>
            </span>

            <!-- {{ 'simulacion.seg' | translate }} perdido en direccion servidor->cliente -->
            <span *ngIf="conversacion.dir == -2">
                <td class="info-izq"></td>
                <td>
                    <span title="{{ 'simulacion.seg' | translate }} {{ conversacion.numseg }}">
                        <img src="assets\img\flechaX.svg" alt="cliente  X--servidor" class="flechaperd"
                            style="transform: scaleX(-1);" draggable="false" />
                    </span>
                </td>
                <td class="info-dcha">
                    <span title="{{ 'simulacion.sn' | translate }}">SN={{ conversacion.snserv }}, </span>
                    <span *ngIf="conversacion.mssserv != 0" title="{{ 'simulacion.mss' | translate }}">
                        MSS={{ conversacion.mssserv }}, </span>
                    <span *ngIf="conversacion.anserv != 0" title="{{ 'simulacion.an' | translate }}">
                        AN={{ conversacion.anserv }},
                    </span>
                    <span title="{{ 'simulacion.datos' | translate }}">D={{ conversacion.dserv }}, </span>
                    <span title="{{ 'simulacion.w' | translate }}">W={{ conversacion.wserv }}</span>
                    <span *ngIf="conversacion.flagserv != null" title="Flags">,
                        <strong>{{ conversacion.flagserv }}</strong>
                    </span>
                </td>
            </span>
        </tr>
    </table>
</span>

<ng-template #loading>
    <div class="load" title="{{ 'simulacion.cargando' | translate }}...">
        <img width="15%" alt="{{ 'simulacion.cargando' | translate }}..." src="assets\img\loading.gif" />
    </div>
</ng-template>